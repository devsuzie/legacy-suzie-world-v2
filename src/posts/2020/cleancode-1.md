---
title: '클린코드 #1 깨끗한 코드'
description: 로버트 C. 마틴의 클린 코드를 읽고 정리한 내용입니다
date: 2020-05-17
tags:
  - Book
layout: layouts/post.njk
------

사수님에게 `클린 코드`라는 책을 추천 받았다. 클린 코드라니. 말만 들어도 경건해지는 기분이다. 이 책의 서문은 코드가 존재하리라. 라는 숭고한 말로 시작한다. 그리고 이어지는 말을 소개한다. "기계가 실행할 정도로 상세하게 요구사항을 명시하는 작업, 바로 이것이 프로그래밍이다. 이렇게 명시한 결과가 바로 코드다. 궁극적으로 코드는 요구사항을 표현하는 언어라는 사실을 명심한다." 이 사실을 명심하면서 1장을 살펴보자.

## 나쁜 코드

### 태도
나쁜 코드의 위험을 이해하지 못하는 관리자의 말을 그대로 따르는 행동은 전문가답지 못하다.

### 원초적 난제
기한을 맞추는 유일한 방법은, 그러니까 빨리 가는 유일한 방법은, 언제나 코드를 최대한 깨끗하게 유지하는 습관이다.

### 깨끗한 코드라는 예술?
“깨끗한 코드를 어떻게 작성할까?” 깨끗한 코드가 무엇인지 모르면 깨끗한 코드를 만들려고 애써봤자 소용이 없다. 깨끗한 코드와 나쁜 코드를 구분할 줄 안다고 깨끗한 코드를 작성할 줄 안다는 뜻은 아니다. `코드 감각`이 있는 프로그래머는 나쁜 모듈을 보면 좋은 모듈로 개선할 방안을 떠올린다. `코드 감각`으로 최고 방안을 선택한 후 여기서 거기까지 이동하는 경로를 계획한다.

## 깨끗한 코드
### 비야네 스트롭스트룹 (Bjarne Stroustrup)
> 나는 우아하고 효율적인 코드를 좋아한다. 논리가 간단해야 버그가 숨어들지 못한다. 의존성을 최대한 줄여야 유지보수가 쉬워진다. 오류는 명백한 전략에 의거해 철저히 처리한다. 성능을 최적으로 유지해야 사람들이 원칙 없는 최적화로 코드를 망치려는 유혹에 빠지지 않는다. 깨끗한 코드는 한 가지를 제대로 한다.  

비야네에 따르면 깨끗한 코드는 ‘보기에 즐거운’ 코드다.

- 효율
  - CPU 자원을 낭비하는 코드는 우아하지 못하다. 우아하지 못한 코드는 바람직하지 않은 결과를 초래한다. 나쁜 코드는 나쁜 코드를 유혹한다. 흔히 나쁜 코드를 고치면서 오히려 더 나쁜 코드를 만든다는 뜻이다.

- 철저한 오류 처리
  - 세세한 사항까지 꼼꼼하게 신경써야한다.
오류처리, 메모리 누수, `경쟁 상태`, 일관성 없는 명명법에 대해서 대충 넘어가지 마라.
깨끗한 코드는 세세한 사항까지 꼼꼼하게 처리하는 코드다.
  - `경쟁 상태`(race condition)란 둘 이상의 입력 또는 조작의 타이밍이나 순서 등이 결과값에 영향을 줄 수 있는 상태를 말한다.

- 한가지를 잘 하는 것
  - 깨끗한 코드는 한가지에 ‘집중’한다. 각 함수와 클래스와 모듈은 주변 상황에 현혹되거나 오염되지 않은 채 한길만 걷는다.


### 그래디 부치 (Grady Booch)
> 깨끗한 코드는 단순하고 직접적이다. 깨끗한 코드는 잘 쓴 문장처럼 읽힌다. 깨끗한 코드는 결코 설계자의 의도를 숨기지 않는다. 오히려 명쾌한 추상화와 단순한 제어문으로 가득하다.   

그래디는 가독성을 강조한다. 깨끗한 코드는 잘 쓴 문장처럼 읽여햐 한다. 좋은 소설과 마찬가지로 깨끗한 코드는 해결할 문제의 긴장을 명확히 드러내야 한다. 긴장을 쌓으며 클라이맥스에 이르렀다가 명백한 해법을 제시하며 긴장과 문제를 풀어야 한다.

코드는 추측이 아니라 사실에 기반해야 한다. 반드시 필요한 내용만 담아야 한다. 코드를 읽는 사람에게 프로그래머가 단호하다는 인상을 줘야 한다. 

추상 클래스란 구체적이지 않은 클래스를 의미한다. `햄버거`, `피자`는 구체적인 음식이지만 `음식`은 구체적이라고 할 수 없다. 이런 관점에서 `음식`을 추상 클래스라고 할 수 있다. 

### 데이브 토마스 (Dave Thomas)
> 깨끗한 코드는 작성자가 아닌 사람도 읽기 쉽고 고치기 쉽다. 단위 테스트 케이스와 인수 테스트 케이스가 존재한다. 깨끗한 코드에는 의미 있는 이름이 붙는다. 의존성은 최소이며 각 의존성을 명확히 정의한다. API는 명확하며 최소로 줄였다.   

데이브는 깨끗한 코드란 `다른` 사람이 고치기 쉽다고 단언한다. 

- 테스트 주도 개발
테스트 케이스가 없는 코드는 깨끗한 코드가 아니다. 아무리 코드가 우아하고 가독성이 높아도, 테스트 케이스가 없으면 깨끗하지 않다.

- 최소
큰 코드보다 작은 코드에 가치를 둔다. 작을수록 좋다.

### 마이클 페더스 (Michael Feathers)
> 깨끗한 코드는 언제나 누군가 주의 깊게 짰다는 느낌을 준다. 고치려고 살펴봐도 딱히 손 댈 곳이 없다. 작성자가 이미 모든 사항을 고려했으므로.   

깨끗한 코드는 주의 깊게 작성한 코드다. 누군가 시간을 들여 깔끔하고 단정하게 정리한 코드다. 세세한 사항까지 꼼꼼하게 신경쓴 코드다. 주의를 기울인 코드다.

### 론 제프리스 (Ron Jeffries)
> 중복을 피하라. 한 기능만 수행하라. 제대로 표현하라. 작게 추상화하라.  

간단한 코드는
1. 모든 테스트를 통과한다.
2. 중복이 없다.
3. 시스템 내 모든 설계 아이디어를 표현한다.
4. 클래스, 메서드, 함수 등을 최대한 줄인다.
5. 중복 줄이기 같은 작업을 여러 차례 반복한다면 코드가 아이디어를 제대로 표현하지 못한다는 증거다.
6. 표현력은 의미 있는 이름을 포함한다. 확정하기 전에 이름을 여러 차례 바꾼다. 이름뿐만이 아니라 여러 기능을 수행하는 객체나 메서드도 찾는다. 객체가 여러 기능을 수행한다면 여러 객체로 나눈다. 메서드가 여러 기능을 수행한다면 메서드 추출 리팩터링 기법을 적용해 기능을 명확히 기술하는 메서드 하나와 기능을 실제로 수행하는 메서드 여러 개로 나눈다.
7. 초반부터 간단한 추상화 고려한다.
8. 집합에서 항목을 찾는다. 어떤 집합에서 특정 항목을 찾아낼 필요가 생겼을 때, 추상 메서드나 추상 클래스를 만들어 실제 구현을 감싼다. 다른 코드는 추상 클래스나 추상 메서드가 제공하는 기능을 사용하므로 실제 구현은 언제든지 바꿔도 괜찮다.

### 워드 커닝햄 (Ward Cunningham)
> 코드를 읽으면서 짐작했던 기능을 각 루틴이 그대로 수행한다면 깨끗한 코드라 불러도 되겠다. 코드가 그 문제를 풀기 위한 언어처럼 보인다면 아름다운 코드라 불러도 되겠다.  

깨끗한 코드는 너무도 잘 짜놓은 코드라 읽는 이가 그 사실을 모르고 넘어간다. 모든 뛰어난 설계처럼 설계자가 코드를 어이 없을 정도로 단순하게 설계했기 때문이다.

프로그램을 단순하게 보이도록 만드는 열쇠는 언어가 아니다. 언어를 단순하게 보이도록 만드는 열쇠는 프로그래머다!

### 우리는 저자다
새 코드를 짜면서 우리는 끊임없이 기존 코드를 읽는다.
기존 코드를 읽어야 새 코드를 짜므로 읽기 쉽게 만들면 사실은 짜기도 쉬워진다.
주변 코드를 읽지 않으면 새 코드를 짜지 못한다. 주변 코드가 읽기 쉬우면 새 코드를 짜기도 쉽다. 주변 코드를 읽기가 어려우면 새 코드를 짜기도 어렵다.

### 보이스카우트 규칙
> 캠프장은 처음 왔을 때보다 더 깨끗하게 해놓고 떠나라.  

체크아웃할 때보다 좀 더 깨끗한 코드를 체크인한다면 코드는 절대 나빠지지 않는다. 한꺼번에 많은 시간과 노력을 투자해 코드를 정리할 필요가 없다. 변수 이름 하나를 개선하고, 조금 긴 함수 하나를 분할하고, 약간의 중복을 제거하고, 복잡한 if문 하나를 정리하면 충분하다. 

### 결론
예술에 대한 책을 읽는다고 예술가가 된다는 보장은 없다. 이 책 역시 읽는다고 뛰어난 프로그래머가 된다는 보장은 없다. 단지 뛰어난 프로그래머가 생각하는 방식과 그들이 사용하는 기술과 기교와 도구를 소개할 뿐이다.

> “연습해, 연습!”

## 느낀 점
얼마 전 태어나서 처음으로 오마카세를 먹으러 갔었다. ‘장인 정신’이라는 것을 그때 느꼈던 것 같다. 회를 써는 모습도, 초밥을 만드는 손길 한 번도, 단순히 음식을 제공하면서 수익을 얻는 것이 아니라 장인 정신으로 해내는 모습이었다. 그런 모습으로 코드를 짤 수 있다면 그게 바로 깨끗한 코드를 만드는 길이 아닐까? 나는 프로그래머가 예술가와 닮아있다고 생각했다. 그 생각이 바뀌진 않았지만 클린코드 1장인 깨끗한 코드를 읽고, 프로그래머는 설계자이고 그보다 더 나아가 `장인 정신을 가진` 설계자라는 생각이 들었다. 아니 되어야 한다는 생각이 들었다. 이제 막 프로그래밍을 시작해 하얀 백지 같은 상태인 나에게 가야 할 길을 알려주는 장인 스승을 만난 것 같아 기쁘다. 이 책을 다 읽는다고 저자가 경고한 것처럼 뛰어난 프로그래머가 되지는 않을 수 있겠지만, 적어도 그들의 코드에 대한 마음가짐만큼은 어느 정도 흡수할 수 있을 것 같아서 앞으로 나올 이야기도 기대된다! 내가 현재 공부하고 있는 언어와 다른 언어로 코드가 작성되어있겠지만 이 책을 추천해준 사수님의 말처럼 반만 소화해도 얻는 게 많을 테니! 화이팅이다! 연습해, 연습.